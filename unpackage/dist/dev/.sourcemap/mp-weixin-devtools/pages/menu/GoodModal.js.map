{"version":3,"names":["store","stores_cart","useCartStore","common_vendor","storeToRefs","updateCart","visible","ref","props","__props","ingredientList","ingredientMap","addMap","goodTotal","onLoad","Promise","resolve","require","then","res","value","default","forEach","item","id","addListTitleShow","computed","show","Object","keys","length","every","_a","consoleg","log","addListTitle","title","push","label","join","totalPrice","ingredientPrice","reduce","pre","price","goodPirce","good","buyNow","addCart","ingredient","_objectSpread2","total","obj","concat","_toConsumableArray2","updateAddMap","updateGoodTotal","open","index","__f__","__expose","$emit","__emit","modalChange","visible2","wx","createComponent","Component"],"sources":["goodModal.vue","RjovY29kZS9CdXJnZXJPcmRlci9wYWdlcy9tZW51L2dvb2RNb2RhbC52dWU"],"sourcesContent":["<template>\r\n\t<Popup v-model:visible=\"visible\" direction=\"bottom\"  background-color=\"#fff\" @change=\"modalChange\">\r\n\t\t<view>\r\n\t\t\t\t\t<view class=\"iconfont icon-close good-close p-1 radius-circle\"></view>\r\n\t\t\t\t<view class=\"flex column good items-center\">\r\n\t\t\t\t\t<view class=\"good-img p-2\">\r\n\t\t\t\t\t\t<image :src=\"props.good?.image\" mode=\"aspectFit\" style=\"width: 100%;\r\n\t\t\t\t\t\t\"></image>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"good-main flex justify-between items-center\">\r\n\t\t\t\t\t\t<text class=\"good-label  fs-md\">{{props.good?.label}}</text>\r\n\t\t\t\t\t\t<text class=\"good-sell fs-sm\">月售{{props.good?.sell}}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"add flex column\">\r\n\t\t\t\t\t\t<text class=\"add-title fs-sm\">来点小料</text>\r\n\t\t\t\t\t\t<view v-for=\"(ingredient,key) in ingredientList\" :key=\"key\"\r\n\t\t\t\t\t\t\tclass=\"add-item flex justify-between items-center\">\r\n\t\t\t\t\t\t\t<text class=\"add-item-label\">{{ingredient.label}}</text>\r\n\t\t\t\t\t\t\t<text class=\"add-item-price\">￥{{ingredient.price}}</text>\r\n\t\t\t\t\t\t\t<AddSubtractButton @reduce=\"(total)=>updateAddMap(ingredient,total)\"\r\n\t\t\t\t\t\t\t\t@add=\"(total)=>updateAddMap(ingredient,total)\"></AddSubtractButton>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t<view class=\"flex justify-between bottom-add p-1\" v-show=\"addListTitleShow\">\r\n\t\t\t\t<text class=\"fs-sm\">已选：{{addListTitle}}</text>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"bottom flex justify-between column\">\r\n\r\n\t\t\t\t<view class=\"flex justify-between bottom-total  m-2\">\r\n\t\t\t\t\t<text class=\"bottom-total-title fs-md\">￥<text\r\n\t\t\t\t\t\t\tclass=\"bottom-total-price fs-xl\">{{totalPrice}}</text>/个</text>\r\n\t\t\t\t\t<AddSubtractButton @reduce=\"updateGoodTotal\" @add=\"updateGoodTotal\" :init=\"1\" :minNumber=\"1\">\r\n\t\t\t\t\t</AddSubtractButton>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"flex justify-between   m-2\">\r\n\t\t\t\t\t<SButton @tap=\"buyNow\" class=\"bottom-btn\">立即购买</SButton>\r\n\t\t\t\t\t<SButton @tap=\"addCart\" class=\"bottom-btn\" primary>加入购物车</SButton>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\r\n\t\t</view>\r\n\t</Popup>\r\n</template>\r\n\r\n<script setup>\r\n\timport {\r\n\t\tcomputed,\r\n\t\tnextTick,\r\n\t\tonUnmounted,\r\n\t\tonUpdated,\r\n\t\tref\r\n\t} from 'vue';\r\n\timport {\r\n\t\tonLoad\r\n\t} from '@dcloudio/uni-app'\r\n\timport {\r\n\t\tuseCartStore\r\n\t} from '/stores/cart';\r\n\timport {\r\n\t\tstoreToRefs\r\n\t} from 'pinia'\r\n\tconst store = useCartStore() //购物车store\r\n\tconst {\r\n\t\tcart\r\n\t} = storeToRefs(store)\r\n\tconst {\r\n\t\tupdateCart\r\n\t} = store\r\n\tconst visible = ref(false)\r\n\tconst props = defineProps({\r\n\t\tgood: {\r\n\t\t\ttype: Object, //当前选择的商品\r\n\t\t\tdefault: () => ({})\r\n\t\t}\r\n\t})\r\n\tconst ingredientList = ref([]) //小料列表数据\r\n\tconst ingredientMap = ref({}) //小料列表映射\r\n\tconst addMap = ref({}) //加料列表数据\r\n\tconst goodTotal = ref(1) //商品个数\r\n\tonLoad(() => {\r\n\t\t//获取数据\r\n\t\timport('/api/add.json').then(res => {\r\n\t\t\tingredientList.value = res.default\r\n\t\t\tres.default.forEach((item) => {\r\n\t\t\t\tingredientMap\r\n\t\t\t\t\t.value[item.id] = item\r\n\t\t\t})\r\n\t\t})\r\n\t})\r\n\tconst addListTitleShow=computed(()=>{\r\n\t\tconst show =  Object.keys(addMap.value).length!=0||Object.keys(addMap.value).every(id=>addMap.value?.[id]!=0)\r\n\t\tconsoleg.log(show,'show')\r\n\t\treturn show\r\n\t})\r\n\t//加料展示标题\r\n\tconst addListTitle = computed(() => {\r\n\t\tconst title = []\r\n\t\tObject.keys(addMap.value).forEach((id) => {\r\n\t\t\tif (addMap.value[id]) title.push(ingredientMap.value[id].label + 'x ' + addMap.value[id])\r\n\t\t})\r\n\t\treturn title.join('、')\r\n\t})\r\n\t//总价格\r\n\tconst totalPrice = computed(() => {\r\n\t\tconst ingredientPrice = Object.keys(addMap.value).reduce((pre, id) => {\r\n\t\t\tpre = pre + ingredientMap.value[id].price * addMap.value[id]\r\n\t\t\treturn pre\r\n\t\t}, 0)\r\n\t\tconst goodPirce = goodTotal.value * (props.good?.price || 0)\r\n\t\treturn ingredientPrice + goodPirce\r\n\t})\r\n\t//跳转购买页面\r\n\tconst buyNow = () => {}\r\n\t//加入购物车\r\n\tconst addCart = () => {\r\n\t\tconst ingredient = []\r\n\t\tObject.keys(addMap.value).forEach((id) => {\r\n\t\t\tif (addMap.value[id]) ingredient.push({\r\n\t\t\t\t...ingredientMap.value[id],\r\n\t\t\t\ttotal: addMap.value[id]\r\n\t\t\t})\r\n\t\t})\r\n\t\tconst obj = {\r\n\t\t\t...props.good,\r\n\t\t\tingredient\r\n\t\t}\r\n\t\tupdateCart((value) => [...value, obj])\r\n\t\tvisible.value=false\r\n\t}\r\n\r\n\t//加减小料\r\n\tconst updateAddMap = (ingredient, total) => {\r\n\t\taddMap.value[ingredient.id] = total\r\n\t}\r\n\t//更新商品个数\r\n\tconst updateGoodTotal = (total) => {\r\n\t\tgoodTotal.value = total\r\n\t}\r\n\t//暴露modal方法\r\n\tconst open = () => {\r\n\t\tconsole.log('调用open')\r\n\t\tvisible.value=true\r\n\t};\r\n\tdefineExpose({\r\n\t\topen\r\n\t})\r\n\t//modal change\r\n\tconst $emit = defineEmits(['change'])\r\n\tconst modalChange = (visible) => {\r\n\t\tconsole.log(visible,'show')\r\n\t\taddMap.value = {}\r\n\t\tgoodTotal.value = 1\r\n\t\t$emit('change', visible)\r\n\t}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n\t@import '../../style/common.scss';\r\n\r\n\t.good {\r\n\t\tposition: relative;\r\n\t\theight: 90vh;\r\n\t\toverflow-y: auto;\r\n\t\tbox-sizing: border-box;\r\n\t\tpadding-bottom: 160rpx;\r\nborder-radius:10px 10px 0 0;\r\n\t\t&-close {\r\n\t\t\tposition: absolute;\r\n\t\t\tright: 30rpx;\r\n\t\t\ttop: 30rpx;\r\n\t\t\tbackground: rgba(0, 0, 0, 0.1);\r\n\t\t\tcolor: #fff;\r\n\r\n\t\t}\r\n\r\n\t\t&-img {\r\n\t\t\t// display: block;\r\n\t\t\twidth: 600rpx;\r\n\t\t\t// height: 100%;\r\n\t\t}\r\n\r\n\t\t&-main {\r\n\t\t\twidth: 700rpx;\r\n\t\t\tbox-sizing: border-box;\r\n\t\t\tborder-bottom: 1px solid $border-base;\r\n\t\t\tpadding: spacing-size(4) 0;\r\n\t\t}\r\n\r\n\t\t&-label {\r\n\t\t\tfont-weight: 500;\r\n\t\t}\r\n\r\n\t\t&-sell {\r\n\t\t\tcolor: $light-gray;\r\n\t\t}\r\n\r\n\t\t.add {\r\n\t\t\twidth: 700rpx;\r\n\r\n\t\t\t&-title {\r\n\t\t\t\tfont-weight: 500;\r\n\t\t\t\tpadding: spacing-size(3) 0;\r\n\t\t\t}\r\n\r\n\t\t\t&-item {\r\n\t\t\t\t// box-sizing: border-box;\r\n\t\t\t\tpadding: spacing-size(2) spacing-size(3);\r\n\r\n\t\t\t\t&:not(last-child) {\r\n\t\t\t\t\tmargin-bottom: spacing-size(4);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbackground: #eee;\r\n\t\t\t\t@include radius-size(base);\r\n\t\t\t\tline-height: 40rpx;\r\n\r\n\t\t\t\t&-label {\r\n\t\t\t\t\tcolor: $dark-gold;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t&-price {\r\n\t\t\t\t\tcolor: $dark-gold;\r\n\t\t\t\t\tmargin: 0 150rpx 0 auto;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t&-number {\r\n\t\t\t\t\tmargin: 0 spacing-size(2);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t&-btn {\r\n\t\t\t\t\twidth: 40rpx;\r\n\t\t\t\t\theight: 40rpx;\r\n\t\t\t\t\tfont-weight: bold;\r\n\t\t\t\t\tborder-radius: 50%;\r\n\r\n\t\t\t\t\t&-add {\r\n\t\t\t\t\t\tcolor: $text-primary ;\r\n\t\t\t\t\t\tbackground: $dark-gold;\r\n\t\t\t\t\t\tposition: relative;\r\n\r\n\t\t\t\t\t\t&::after {\r\n\t\t\t\t\t\t\tcontent: '+';\r\n\t\t\t\t\t\t\tposition: absolute;\r\n\t\t\t\t\t\t\ttop: 0rpx;\r\n\t\t\t\t\t\t\tleft: 50%;\r\n\t\t\t\t\t\t\ttransform: translateX(-50%);\r\n\t\t\t\t\t\t\t@include font-size(lg);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t&-sub {\r\n\t\t\t\t\t\tborder: 1px solid $dark-gold;\r\n\t\t\t\t\t\tcolor: $dark-gold;\r\n\t\t\t\t\t\tposition: relative;\r\n\r\n\t\t\t\t\t\t&::after {\r\n\t\t\t\t\t\t\tcontent: '—';\r\n\t\t\t\t\t\t\tposition: absolute;\r\n\t\t\t\t\t\t\ttop: 0rpx;\r\n\t\t\t\t\t\t\tleft: 50%;\r\n\t\t\t\t\t\t\ttransform: translateX(-50%);\r\n\t\t\t\t\t\t\t@include font-size(xs);\r\n\t\t\t\t\t\t\tfont-weight: 500;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t.bottom-add {\r\n\t\tbackground: #eee;\r\n\t\tposition: fixed;\r\n\t\twidth: 100%;\r\n\t\tz-index: 10;\r\n\t\tbottom: 160rpx;\r\n\t\tbox-sizing: border-box;\r\n\t}\r\n\r\n\t.bottom {\r\n\t\tposition: fixed;\r\n\t\twidth: 100%;\r\n\t\tbox-sizing: border-box;\r\n\t\tz-index: 10;\r\n\t\tbottom: 0;\r\n\t\theight: 160rpx;\r\n\t\tbackground: #fff;\r\n\r\n\t\t&-total {\r\n\t\t\t&-title {\r\n\t\t\t\tcolor: $dark-gold;\r\n\t\t\t}\r\n\r\n\t\t\t&-price {}\r\n\t\t}\r\n\r\n\t\t&-btn {\r\n\t\t\t// box-sizing: border-box;\r\n\t\t\twidth: 352rpx;\r\n\t\t}\r\n\t}\r\n</style>","import Component from 'F:/code/BurgerOrder/pages/menu/goodModal.vue'\nwx.createComponent(Component)"],"mappings":"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","ignoreList":[]}